"use strict";var letterShowTime=100;var scriptPath="script.json";var prefaceDiv=document.getElementById("preface");var codeWrapper=document.querySelector("#code-side .wrapper");var promptWrapper=document.querySelector("#prompt-side .wrapper");var nextButton=document.querySelector("#nav #next");var previousButton=document.querySelector("#nav #previous");var currentScene=void 0;var scenes=void 0;document.addEventListener("DOMContentLoaded",function(){loadJSON(function(response){var json=JSON.parse(response);scenes=json.scenes;currentScene=scenes[0];runScene(currentScene)});nextButton.addEventListener("click",function(){if(scenes!==undefined){var currentIndex=scenes.findIndex(function(scene){return scene===currentScene});if(currentIndex+1<scenes.length){currentScene=scenes[currentIndex+1];runScene(currentScene)}}});previousButton.addEventListener("click",function(){if(scenes!==undefined){var currentIndex=scenes.findIndex(function(scene){return scene===currentScene});if(currentIndex-1>=0){currentScene=scenes[currentIndex-1];runScene(scenes[currentIndex-1])}}})});function loadJSON(callback){var xobj=new XMLHttpRequest;xobj.overrideMimeType("application/json");xobj.open("GET",scriptPath,true);xobj.onreadystatechange=function(){if(xobj.readyState==4&&xobj.status==200){callback(xobj.responseText)}};xobj.send(null)}function runScene(scene){codeWrapper.innerHTML="";prefaceDiv.innerHTML="";promptWrapper.innerHTML="";prefaceDiv.innerHTML=scene.preface;var codeInitialDelay=0;var _loop=function _loop(codeLine){var codeSpan=document.createElement("span");codeSpan.textContent=codeLine;codeSpan.className="line hide";codeWrapper.appendChild(codeSpan);convertToHiddenLetters(codeSpan);setTimeout(function(){codeSpan.classList.remove("hide");typeCode(codeSpan)},codeInitialDelay);codeInitialDelay+=letterShowTime*codeSpan.childElementCount};var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=scene.code.split(/\n/)[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var codeLine=_step.value;_loop(codeLine)}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=scene.prompt.split(/\n/)[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var promptLine=_step2.value;var promptSpan=document.createElement("span");promptSpan.textContent=promptLine;promptSpan.className="line hide";promptWrapper.appendChild(promptSpan);promptSpan.classList.remove("hide")}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally{try{if(!_iteratorNormalCompletion2&&_iterator2.return){_iterator2.return()}}finally{if(_didIteratorError2){throw _iteratorError2}}}}function convertToHiddenLetters(line){var text=line.textContent;var letters="";for(var i=0;i<text.length;i++){letters+="<span class=\"letter hide\">"+text[i]+"</span>"}line.innerHTML=letters}function typeCode(line){for(var i=0;i<line.children.length;i++){(function(i){setTimeout(function(){line.children[i].classList.remove("hide")},letterShowTime*i)})(i)};}
