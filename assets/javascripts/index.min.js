"use strict";var letterShowTime=100;var scriptPath="script.json";var prefaceDiv=document.getElementById("preface");var codepad=document.querySelector("#code-side .codepad");var promptWrapper=document.querySelector("#prompt-side .wrapper");var nextButton=document.querySelector("#nav #next");var previousButton=document.querySelector("#nav #previous");var runButtons=document.querySelectorAll(".run");var noOutputInstruction="(No output for this - click/tap the \">\" button to proceed)";var currentScene=void 0;var scenes=void 0;document.addEventListener("DOMContentLoaded",function(){loadJSON(function(response){var json=JSON.parse(response);scenes=json.scenes;currentScene=scenes[0];runScene(currentScene)});nextButton.addEventListener("click",function(){if(scenes!==undefined){var currentIndex=scenes.findIndex(function(scene){return scene===currentScene});if(currentIndex+1<scenes.length){currentScene=scenes[currentIndex+1];runScene(currentScene)}}});previousButton.addEventListener("click",function(){if(scenes!==undefined){var currentIndex=scenes.findIndex(function(scene){return scene===currentScene});if(currentIndex-1>=0){currentScene=scenes[currentIndex-1];runScene(scenes[currentIndex-1])}}});var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=runButtons[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var runButton=_step.value;runButton.addEventListener("click",function(){if(currentScene!==undefined){promptWrapper.innerHTML="";revealPromptOutput(currentScene)}})}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}});function loadJSON(callback){var xobj=new XMLHttpRequest;xobj.overrideMimeType("application/json");xobj.open("GET",scriptPath,true);xobj.onreadystatechange=function(){if(xobj.readyState==4&&xobj.status==200){callback(xobj.responseText)}};xobj.send(null)}function runScene(scene){codepad.innerHTML="";prefaceDiv.innerHTML="";promptWrapper.innerHTML="";prefaceDiv.innerHTML=scene.preface;var codeInitialDelay=0;var _loop=function _loop(codeLine){var codeSpan=document.createElement("span");codeSpan.textContent=codeLine;codeSpan.className="line hide";codepad.appendChild(codeSpan);convertToHiddenLetters(codeSpan);setTimeout(function(){codeSpan.classList.remove("hide");typeCode(codeSpan)},codeInitialDelay);codeInitialDelay+=letterShowTime*codeSpan.childElementCount};var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=scene.code.split(/\n/)[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var codeLine=_step2.value;_loop(codeLine)}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally{try{if(!_iteratorNormalCompletion2&&_iterator2.return){_iterator2.return()}}finally{if(_didIteratorError2){throw _iteratorError2}}}}function convertToHiddenLetters(line){var text=line.textContent;var letters="";for(var i=0;i<text.length;i++){letters+="<span class=\"letter hide\">"+text[i]+"</span>"}line.innerHTML=letters}function typeCode(line){for(var i=0;i<line.children.length;i++){(function(i){setTimeout(function(){line.children[i].classList.remove("hide")},letterShowTime*i)})(i)};}function revealPromptOutput(scene){if(scene.prompt.length===0){var promptSpan=document.createElement("span");promptSpan.textContent=noOutputInstruction;promptSpan.className="line";promptWrapper.appendChild(promptSpan)}else{var _iteratorNormalCompletion3=true;var _didIteratorError3=false;var _iteratorError3=undefined;try{for(var _iterator3=scene.prompt.split(/\n/)[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=true){var promptLine=_step3.value;var _promptSpan=document.createElement("span");_promptSpan.textContent=promptLine;_promptSpan.className="line";promptWrapper.appendChild(_promptSpan)}}catch(err){_didIteratorError3=true;_iteratorError3=err}finally{try{if(!_iteratorNormalCompletion3&&_iterator3.return){_iterator3.return()}}finally{if(_didIteratorError3){throw _iteratorError3}}}}}
